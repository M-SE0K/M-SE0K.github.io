{{/* Display a movie card for listing pages using custom_card view */}}
{{ $page := . }}

<div class="movie-card-wrapper">
  <div class="movie-card">
    <div class="movie-poster-container">
      <img src="{{ $page.Params.poster | default "/movie/default.jpg" }}" alt="{{ $page.Title }}" class="movie-poster">
      <div class="movie-rating">⭐ {{ $page.Params.rating | default "N/A" }}</div>
      <div class="movie-overlay">
        <span style="color: white; font-weight: bold;">클릭하여 상세보기</span>
      </div>
    </div>
    <div class="movie-info-card">
      <h3 class="movie-title">{{ $page.Title }}</h3>
      <p class="movie-meta">
        {{ $page.Params.director | default "Unknown" }} | 
        {{ $page.Params.year | default "Unknown" }} | 
        {{ $page.Params.duration | default "Unknown" }}
      </p>
      <div class="movie-genre">
        {{ range $page.Params.genres }}
          <span class="genre-tag">{{ . }}</span>
        {{ end }}
      </div>
    </div>
  </div>
  <div class="movie-reason">
    {{/* Get the first paragraph from the content as summary */}}
    {{ $content := $page.Content }}
    {{ $firstHeading := findRE `^##\s+💭` $content 1 }}
    {{ if $firstHeading }}
      {{ $parts := split $content "## 💭" }}
      {{ if gt (len $parts) 1 }}
        {{ $reasonContent := index $parts 1 }}
        {{ $reasonContent = $reasonContent | markdownify }}
        <div>
          <h4>💭 좋아하는 이유</h4>
          {{ $reasonContent | truncate 500 "..." }}
        </div>
      {{ end }}
    {{ else }}
      {{/* Fallback: use the page content */}}
      <div>
        <h4>💭 좋아하는 이유</h4>
        <p>{{ $page.Summary | default "상세한 감상평은 페이지에서 확인하세요." | truncate 500 "..." }}</p>
      </div>
    {{ end }}
  </div>
</div>
